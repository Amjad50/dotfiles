# ============================================================================
# Tag Definitions & Usage Guide
# ============================================================================
# Tags categorize machines by characteristics. The 'default' tag is ALWAYS
# auto-applied. Add others to machines in the machines: section below.
#
# TO ADD A NEW TAG:
#   1. Add entry below (with description)
#   2. Add its packages under tag_packages: below
#   3. Add the tag to machines that need it
#
# TO ADD A NEW MACHINE:
#   1. Add entry under machines: with distro + tags
#   2. Include optional distro-specific package overrides (packages:)
#   3. Include optional setup scripts (repositories:)
# ============================================================================
tags:
  default:
    description: "Default packages auto-applied to all machines"
  dev:
    description: "Development tools (compilers, language managers, version control)"
  personal:
    description: "Laptop-specific packages (syncing, power management)"

# ============================================================================
# Packages organized by tags
# Each tag can have 'common' (distro-agnostic) and distro-specific sections
# The 'default' tag is auto-applied to all machines
# ============================================================================
tag_packages:
  default:
    common:
      - neovim
      - git-extras
      - direnv
      - ripgrep
      - bat
      - git-lfs
      - mtr
    arch:
      - bind-tools
    fedora:
      - bind-utils

  dev:
    common:
      - uv
      - bun
      - fd
      - mold
      - lazygit
    arch:
      - git-delta
      - base-devel
      - github-cli
      - eza
    fedora:
      - delta
      - fd-find
      - gh
      - eza

  personal:
    common:
      - btrfs-assistant
      - syncthing
      - typst
    arch:
      - pinentry
    fedora:
      - pinentry-qt
      - google-noto-color-emoji-fonts
      - google-noto-sans-fonts
      - google-noto-mono-fonts

# ============================================================================
# Machine Configurations
# ============================================================================
# DISTRO OPTIONS: arch, fedora, debian
# TAGS: default (auto), dev, personal, or define new ones above
#
# Example minimal machine (headless/SSH server):
#   my-server:
#     distro: debian
#     tags: []  # Gets only 'default' packages
#     packages:
#       apt: []
#
# Example full setup (dev laptop):
#   my-laptop:
#     distro: arch
#     tags: [dev, personal]
#     packages:
#       pacman: []  # Optional: add distro-specific packages
#     repositories:
#       pacman: []  # Optional: setup scripts
# ============================================================================
machines:
  amjad-red:
    distro: arch
    tags: [dev]

    packages:
      pacman: []

    repositories:
      pacman:
        - |
          if ! grep -q "\[chaotic-aur\]" /etc/pacman.conf; then
            echo "    → Installing Chaotic-AUR keyring..."
            sudo pacman-key --recv-key 3056513887B78AEB --keyserver keyserver.ubuntu.com
            sudo pacman-key --lsign-key 3056513887B78AEB
            echo "    → Installing Chaotic-AUR packages..."
            sudo pacman -U --noconfirm 'https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-keyring.pkg.tar.zst'
            sudo pacman -U --noconfirm 'https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-mirrorlist.pkg.tar.zst'
            echo "    → Adding Chaotic-AUR to pacman.conf..."
            echo -e "\n[chaotic-aur]\nInclude = /etc/pacman.d/chaotic-mirrorlist" | sudo tee -a /etc/pacman.conf > /dev/null
            echo "    → Syncing package databases..."
            sudo pacman -Sy
            echo "    → Chaotic-AUR setup complete"
          else
            echo "    → Chaotic-AUR already configured"
          fi

  amjad-T495:
    distro: arch
    tags: [dev, personal]

    packages:
      pacman: []

    repositories:
      pacman:
        - |
          if ! grep -q "\[chaotic-aur\]" /etc/pacman.conf; then
            echo "    → Installing Chaotic-AUR keyring..."
            sudo pacman-key --recv-key 3056513887B78AEB --keyserver keyserver.ubuntu.com
            sudo pacman-key --lsign-key 3056513887B78AEB
            echo "    → Installing Chaotic-AUR packages..."
            sudo pacman -U --noconfirm 'https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-keyring.pkg.tar.zst'
            sudo pacman -U --noconfirm 'https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-mirrorlist.pkg.tar.zst'
            echo "    → Adding Chaotic-AUR to pacman.conf..."
            echo -e "\n[chaotic-aur]\nInclude = /etc/pacman.d/chaotic-mirrorlist" | sudo tee -a /etc/pacman.conf > /dev/null
            echo "    → Syncing package databases..."
            sudo pacman -Sy
            echo "    → Chaotic-AUR setup complete"
          else
            echo "    → Chaotic-AUR already configured"
          fi

  amjad-fed:
    distro: fedora
    tags: [dev, personal]

    packages:
      dnf: []
      flatpak:
        - io.beekeeperstudio.Studio
        #- com.getmailspring.Mailspring

    repositories:
      dnf:
        #- https://download.opensuse.org/repositories/home:/mkittler/Fedora_$FEDORA_VER/home:mkittler.repo

